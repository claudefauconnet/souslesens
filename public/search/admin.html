<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../common/js/jquery/jquery.min.js"></script>
    <script src="../common/js/jquery/jquery-ui.min.js"></script>
    <script src="../common/js/common.js"></script>
    <script src="../common/js/socket.io.js"></script>
    <script src="../common/js/jsTree/jstree.min.js"></script>
    <script src="../common/js/jsTreeController.js"></script>
    <script src="../semanticWeb/skosTree.js"></script>
    <script src="./js/admin.js"></script>
    <link rel="stylesheet" href="../common/js/jquery/jquery-ui.min.css"/>
    <link rel="stylesheet" href="../common/js/jsTree/themes/default/style.min.css"/>

    <style>
        td {
            vertical-align: top;
        }

    </style>
    <script>

        $(function () {

            $("#wordsSelect").keypress(function (e) {
                if (e.ctrlKey)
                    wordSelectMode = "exclude"
                else
                    wordSelectMode = "include"

            })
            $("#tabs").tabs();
            /*  $("#entitiesSelect option").draggable({
                  start: function( event, ui ) {
                      var x=1
              }
              });*/
            jsTreeController.addtionalMenuItems["addConcept"] =

                {
                    "separator_before": false,
                    "separator_after": false,
                    "label": "addWord",
                    "action": function (obj, xx, zz) {
                        var parent = obj.reference[0].id;
                        parent = parent.substring(0, parent.indexOf("_anchor"))
                        //   var childrens = $("#treeDiv1").jstree("get_children_dom",parent);
                        var word = $("#entitiesSelect").val();
                        var id = Math.round(Math.random() * 10000000);
                        var node;
                        if (parent.indexOf("synonyms_") != 0) {
                            node = {
                                id: "concept_" + id,
                                text: word,
                                type: "concept",
                                children: [{id: "synonyms_" + id, text: "synonyms", type: "synonym"}]
                            };

                        } else {
                            node = {id: "syn_" + id, text: word, type: "synonym"};
                        }

                        $('#treeDiv1').jstree('create_node', parent, node, 'first');
                        $("#treeDiv1").jstree("open_node", parent);
                        /*  if (parent.indexOf("synonyms_") != 0) {
                              var synNode = {id: "synonyms_" + id, text: "synonyms",type:"synonym"};
                              $('#treeDiv1').jstree('create_node', "concept_" +id, synNode, 'first');
                              $("#treeDiv1").jstree("open_node", "concept_" +id);
                          }*/


                    }
                }


            var url = window.location.href;
            var p = url.indexOf('/search');
            url = url.substring(0, p);
            var socket = io.connect(url);
            socket.on('connect', function (data) {
                socket.emit('join', 'Hello World from client');
            });
            socket.on('messages', function (message) {
                if (!message || message.length == 0)
                    return;
                if (typeof message == 'string') {
                    color = "blue";
                    if (message.toLowerCase().indexOf("error") > -1)
                        color = "red";


                    $("#message").css("color", color);
                    $("#message").append(message + "<br>");
                }
            })


        });


    </script>
</head>
<body>
<p align="center"><B>Souslesens Search admin</B></p>
<table>
    <tr>
        <td>
            index
        </td>
        <td>
            <input id="indexName" value="jfm">
        </td>
    </tr>
    <tr>
        <td>
            mappings type
        </td>
        <td>
            <input id="mappingsType" value="general_document">
        </td>
    </tr>
</table>

<div id="tabs">

    <ul>
        <li><a href="#makeDocIndexTab">make Doc Index</span></a></li>
        <li><a href="#makeMongoIndexTab">make Mongo Index</span></a></li>
        <li><a href="#thesaurusTab">Thesaurus</span></a></li>
        <li><a href="#makeClassifierTab">make Classifier</span></a></li>


    </ul>


    <div id="makeDocIndexTab">

        <table>
            <tr>
                <td>
                    rootDir
                </td>
                <td>
                    <input id="rootDir">
                </td>
            </tr>

            <tr>
                <td>
                    <button onclick="admin.elasticExec('indexDocDirInNewIndex')">indexDocDirInNewIndex</button>
                </td>
                <td>
                    <button onclick="admin.elasticExec('indexDirInExistingIndex')">indexDirInExistingIndex</button>
                </td>
            </tr>

        </table>
    </div>
    <div id="makeClassifierTab">
        <table>
            <tr>
                <td>
                    nWords
                </td>
                <td>
                    <input id="nWords" value="200">
                </td>
            </tr>

            <tr>
                <td>
                    minFreq
                </td>
                <td>
                    <input id="minFreq" value="10">
                </td>
            </tr>

            <tr>

                <td>
                    &nbsp;
                </td>
                <td>
                    <button onclick="admin.elasticExec('createIndexClassifier')">createIndexClassifier</button>
                </td>
            </tr>


        </table>

    </div>
    <div id="makeMongoIndexTab">
        <table>
            <tr>
                <td>
                    mongo DB
                </td>
                <td>
                    <input id="mongoDB">
                </td>
            </tr>
            <tr>
                <td>
                    mongo Collection
                </td>
                <td>
                    <input id="mongoCollection">
                </td>
            </tr>
            <tr>
                <td>
                    mongoQuery
                </td>
                <td>
                    <input id="mongoQuery" value="{}">
                </td>
            </tr>

            <tr>
                <td>
                    <button onclick="admin.elasticExec('indexMongo')">index Mongo Collection</button>
                </td>

            </tr>

        </table>

    </div>


    <div id="thesaurusTab">
        <table>
            <tr>
                <td></td>


                <td>associated words</td>
                <td></td>
                <td>entities</td>

                <td>thesaurus</td>
            <tr>
            </tr>
            <td>
                size<input id="associatedWordsSize" size="5" value="100">
                <br>
                seed word<input id="seedWord" size="10" value="*">
                <br>
                minWordLength<input id="minWordLength" size="5" value="3">
                <br>
                <button onclick="admin.elasticExec('listAssociatedWords')">list Associated words</button>
                <br>
                exclude<br> <select id="stopWordsSelect" size="10" onclick="admin.includeWord(this)">

            </select>

            </td>


            <td>
                <select id="wordsSelect" size="20" onclick="admin.onWordSelect(this)">

                </select>
            </td>
            <td>
                <button onclick="admin.addAllWordsToEntitiesSelect()">select all</button>
                <br>
                <button onclick="admin.removeEntities()">remove entity</button>
            </td>
            <td>
                <select id="entitiesSelect" multiple="multiple" size="20" onclick="admin.includeWord(this)">

                </select>
            </td>


            <td>

                <button onclick="admin.generateThesaurus()">generate thesaurus</button>
                <hr>
                ontologies<input id="ontologies" value='["BNF"]'>

                <br> lang<input id="lang" value='fr'>
                <br>


                <br>
                <button onclick="admin.setWordNetSynonyms();">enrich synonyms</button>
            </td>
            <td>
                <div id="treeContainer1" class="jsTree">
                    <div id="treeDiv1">
                    </div>
                </div>
            </td>
            <td>
                <table>
                    <tr>

                    </tr>
                    <tr>
                        <td>
                            <hr>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            thesaurus<input id=" skosInput1 " value="" size="12">
                            <button onclick="skosTree.loadTree('treeDiv1','skosInput1')">load</button>
                            <br>
                            <button onclick="skosTree.createTree('treeDiv1')">create</button>
                            <button onclick="skosTree.saveTree('treeDiv1','skosInput1')">save</button>
                            <br>
                            <input id="searchInput1">
                            <button onclick="skosTree.searchTree('searchInput1')">search</button>
                            <br>

                        </td>
                    </tr>
                </table>
            </td>

            </tr>

        </table>
    </div>

</div>
<div id="message"></div>

</body>
</html>